generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url = env("DATABASE_URL")
}

model Users {
  id Int @id @default(autoincrement())
  createdAt DateTime @default(now())
  lastActive DateTime @default(now()) @updatedAt
  username String @unique
  email String 
  password String
  posts Posts[]
  votes Votes[]
  comments Comments[]
  sessions Sessions[]
  profilePictures ProfilePictures?
  profile Profiles?
}

model ProfilePictures {
  id Int @id @default(autoincrement())
  user Users @relation(fields: [userId], references: [id])
  userId Int @unique
  url String @unique
}

model Profiles {
  id Int @id @default(autoincrement())
  user Users @relation(fields: [userId], references: [id])
  userId Int @unique
  bio String
  location String
  website String
}

model Posts {
  id Int @id @default(autoincrement())
  postedAt DateTime @default(now())
  text String
  author Users @relation(fields: [authorId], references: [id])
  authorId Int
  votes Votes[]
  comments Comments[]
}

enum VoteType {
  UPVOTE
  DOWNVOTE
}

model Votes {
  id Int @id @default(autoincrement())
  voteType VoteType
  post Posts @relation(fields: [postId], references: [id])
  postId Int
  user Users @relation(fields: [userId], references: [id])
  userId Int
}

model Comments {
  id Int @id @default(autoincrement())
  createdAt DateTime @default(now())
  text String
  author Users @relation(fields: [authorId], references: [id])
  authorId Int
  post Posts @relation(fields: [postId], references: [id])
  postId Int
}

model Sessions {
  id Int @id @default(autoincrement())
  expiresAt DateTime
  user Users @relation(fields: [userId], references: [id])
  userId Int
  token String
}
